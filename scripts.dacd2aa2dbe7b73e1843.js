"use strict";!function(t){var r=t.document,i=t.Math,e=function(t,r){var i;for(i in r)t[i]=r[i]},n=function(t,r){if(r=r||"",!t)throw new Error(r)},a=function(t,i){n("canvas"===t.nodeName.toLowerCase(),"A canvas element is excepted.");var a={width:t.width,height:t.height,useWorker:"function"==typeof Worker,workerPath:"assets/creeper.js"};e(a,i),this.width=a.width,this.height=a.height;var o=r.createElement("canvas");if(o.width=this.width,o.height=this.height,this.ctx=t.getContext("2d"),this.tmpCtx=o.getContext("2d"),a.useWorker){var s=this;this._queue=[],this.worker=new Worker(a.workerPath),this.worker.onmessage=function(t){var r=s.createImageData(s.width,s.height);if("undefined"==typeof Uint8ClampedArray)for(var i=0;i<t.data.length;i++)r.data[i]=t.data[i];else r.data.set(t.data);for(i=0;i<s._queue.length;i++)r.data=s._queue[i](r.data);s._queue=[],s.ctx.clearRect(0,0,s.width,s.height),s.ctx.putImageData(r,0,0)},this.worker.postMessage({type:"init",w:this.width,h:this.height})}};e(a.prototype,{load:function(t,r,i){"function"==typeof r&&(i=r,r=!0),r=void 0===r||r;var e=new Image,n=this;return e.onload=function(){r?(n.ctx.drawImage(this,0,0,this.width,this.height,0,0,n.width,n.height),n.tmpCtx.drawImage(this,0,0,this.width,this.height,0,0,n.width,n.height)):(n.ctx.drawImage(this,0,0,this.width,this.height),n.tmpCtx.drawImage(this,0,0,this.width,this.height)),i.call(n)},e.crossOrigin=!0,e.src=t,this},restore:function(){return this.ctx.clearRect(0,0,this.width,this.height),this.ctx.drawImage(this.tmpCtx.canvas,0,0,this.width,this.height),this},save:function(){return this.tmpCtx.clearRect(0,0,this.width,this.height),this.tmpCtx.drawImage(this.ctx.canvas,0,0,this.width,this.height),this},toDataURL:function(){return this.ctx.canvas.toDataURL("image/png")},process:function(t){for(var r=this.ctx.getImageData(0,0,this.width,this.height),i=0;i<this.width;i++)for(var e=0;e<this.height;e++){var n=4*(e*this.width+i),a=t(r.data[n],r.data[n+1],r.data[n+2],r.data[n+3],i,e);r.data[n]=a[0],r.data[n+1]=a[1],r.data[n+2]=a[2],r.data[n+3]=a[3]}return this.ctx.clearRect(0,0,this.width,this.height),this.ctx.putImageData(r,0,0),this},getContext:function(){return this.ctx},luminance:function(t,r,i){return.2126*t+.7152*r+.0722*i},createImageData:function(t,r){return this.tmpCtx.createImageData(t,r)},toHSL:function(t,r,e){var n,a,o=i.max(t/=255,r/=255,e/=255),s=i.min(t,r,e),h=(o+s)/2;if(o===s)n=a=0;else{var u=o-s;switch(a=h>.5?u/(2-o-s):u/(o+s),o){case t:n=(r-e)/u+(r<e?6:0);break;case r:n=(e-t)/u+2;break;case e:n=(t-r)/u+4}}return{h:n/=6,s:a,l:h}},toRGB:function(t,r,i){var e,n,a;if(0==r)e=n=a=i;else{var o=function(t,r,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(r-t)*i:i<.5?r:i<2/3?t+(r-t)*(2/3-i)*6:t},s=i<.5?i*(1+r):i+r-i*r,h=2*i-s;e=o(h,s,t+1/3),n=o(h,s,t),a=o(h,s,t-1/3)}return{r:255*e,g:255*n,b:255*a}},colorTempToRGB:function(t){var r,e;return(t/=100)<=66?(r=255,e=i.min(i.max(99.4708025861*i.log(t)-161.1195681661,0),255)):(r=i.min(i.max(329.698727446*i.pow(t-60,-.1332047592),0),255),e=i.min(i.max(288.1221695283*i.pow(t-60,-.0755148492),0),255)),{r:r,g:e,b:t>=66?255:t<=19?0:i.min(i.max(138.5177312231*i.log(t-10)-305.0447927307,0),255)}},equalizeHistogram:function(t,r){var i=t.length;r||(r=t);for(var e=new Float32Array(256),n=0,a=0;a<i;++a)++e[~~t[a]],++n;var o=e[0];for(a=1;a<256;++a)o=e[a]+=o;var s=255/n;for(a=0;a<i;++a)r[a]=e[~~t[a]]*s;return r},_toWorker:function(t){if(this.worker)return e(t,{data:this.ctx.getImageData(0,0,this.width,this.height).data}),this.worker.postMessage(t),this;n(!1,"No web worker support!")},queue:function(t){if(this.worker)this._queue.push(t);else{var r=this.ctx.getImageData(0,0,this.width,this.height);r.data=t(r.data),this.ctx.putImageData(r,0,0)}return this}}),e(a.prototype,{greyscale:function(t){t=void 0===t?1:i.min(i.max(t,0),1);var r=this;return this.process((function(i,e,n,a){var o=r.luminance(i,e,n);return[o*t+i*(1-t),o*t+e*(1-t),o*t+n*(1-t),a]}))},threshold:function(t){t=t||127;var r=this;return this.process((function(i,e,n,a){var o=r.luminance(i,e,n)>t?255:0;return[o,o,o,a]}))},invert:function(t){return t=void 0===t?1:i.min(i.max(t,0),1),this.process((function(r,i,e,n){return[(255-r)*t+r*(1-t),(255-i)*t+i*(1-t),(255-e)*t+e*(1-t),n]}))},sepia:function(t){return t=void 0===t?1:i.min(i.max(t,0),1),this.process((function(r,i,e,n){return[(.393*r+.769*i+.189*e)*t+r*(1-t),(.349*r+.686*i+.168*e)*t+i*(1-t),(.272*r+.534*i+.131*e)*t+e*(1-t),n]}))},hdr:function(){var t=function(t){return t>0&&t<=127?t=i.sin(i.PI*(90-t/4)/180)*t:t>127&&(t=i.sin(i.PI*(90-(255-t)/4)/180)*t),t};return this.process((function(r,i,e,n){return[t(r),t(i),t(e),n]}))}}),e(a.prototype,{noise:function(t,r){return n(t>=0,"Noise amount must be a positive number."),r=r||!1,this.process((function(e,n,a,o){var s=-t/2+i.random()*t*2;return[e+s,n+s,a+s,r?o+s:o]}))},glow:function(t){var r=this;return this.blur(t),this.queue((function(t){for(var i=r.ctx.getImageData(0,0,r.width,r.height),e=0;e<t.length;e+=4)t[e]=255-(255-t[e])*(255-i.data[e])/255,t[e+1]=255-(255-t[e+1])*(255-i.data[e+1])/255,t[e+2]=255-(255-t[e+2])*(255-i.data[e+2])/255,t[e+3]=255-(255-t[e+3])*(255-i.data[e+3])/255;return t}))},colorMatrix:function(t){return this.process((function(r,i,e,n){return[r*t[0]+i*t[1]+e*t[2]+n*t[3]+255*t[20],r*t[5]+i*t[6]+e*t[7]+n*t[8]+255*t[21],r*t[10]+i*t[11]+e*t[12]+n*t[13]+255*t[22],r*t[15]+i*t[16]+e*t[17]+n*t[18]+255*t[23]]}))},equalize:function(){var t=this,r=new Uint8ClampedArray(this.width*this.height),i=0;return this.process((function(e,n,a,o){return r[i]=t.luminance(e,n,a),i++,[e,n,a,o]})),this.equalizeHistogram(r),i=0,this.process((function(e,n,a,o){var s=t.toHSL(e,n,a);s.l=r[i]/255,i++;var h=t.toRGB(s.h,s.s,s.l);return[h.r,h.g,h.b,o]}))},tv:function(){return this.process((function(t,r,e,n,a,o){var s=80*i.sin(o);return[t-s,r-s,e-s,n]})),this.noise(50)}}),e(a.prototype,{hue:function(t,r){n(void 0!==t,"Hue must be specified.");var i=this;return r=r||!1,this.process((function(e,n,a,o){var s=i.toHSL(e,n,a);s.h=r?t/360:s.h+t/360;var h=i.toRGB(s.h,s.s,s.l);return[h.r,h.g,h.b,o]}))},saturation:function(t,r){n(void 0!==t,"Saturation must be specified.");var e=this;return r=r||!1,this.process((function(n,a,o,s){var h=e.toHSL(n,a,o);h.s=i.min(i.max(r?t:h.s+t,0),1);var u=e.toRGB(h.h,h.s,h.l);return[u.r,u.g,u.b,s]}))},brightness:function(t){return n(void 0!==t,"Brightness must be set"),this.process((function(r,i,e,n){return[r+t,i+t,e+t,n]}))},contrast:function(t){return n(void 0!==t,"Contrast level must be set."),t=i.pow((t+100)/100,2),this.process((function(r,i,e,n){return[255*((r/255-.5)*t+.5),255*((i/255-.5)*t+.5),255*((e/255-.5)*t+.5),n]}))},gamma:function(t){return n(void 0!==t,"Gamma level must be set."),this.process((function(r,i,e,n){return[r*t,i*t,e*t,n]}))},gammaRGB:function(t,r,i){return n(void 0!==t&&void 0!==r&&void 0!==i,"Gamma level must be set."),this.process((function(e,n,a,o){return[e*t,n*r,a*i,o]}))},vibrance:function(t){return n(void 0!==t,"Vibrance level must be set."),t*=-1,this.process((function(r,e,n,a){var o=i.max(r,e,n),s=2*i.abs(o-(r+e+n)/3)/255*t/100;return r!==o&&(r+=(o-r)*s),e!==o&&(e+=(o-e)*s),n!==o&&(n+=(o-n)*s),[r,e,n,a]}))},whiteBalance:function(t){var r=this.colorTempToRGB(t);return this.process((function(t,i,e,n){return[t*(255/r.r),i*(255/r.g),e*(255/r.b),n]}))}}),e(a.prototype,{convolute:function(t,r,e){if(n(void 0!==t,"Convolution matrix must be set."),n(void 0!==r,"Offset must be set."),e=e||!0,this.worker)this._toWorker({type:"convolute",matrix:t,offset:r,opaque:e});else{for(var a=this.ctx.getImageData(0,0,this.width,this.height),o=i.round(i.sqrt(t.length)),s=i.floor(o/2),h=a.data,u=a.width,c=a.height,f=u,d=this.createImageData(f,p=c),l=d.data,x=e?1:0,v=0;v<p;v++)for(var g=0;g<f;g++){for(var p=v,y=g,m=4*(v*f+g),w=0,b=0,C=0,A=0,I=0;I<o;I++)for(var M=0;M<o;M++){var k=p+I-s,F=y+M-s;if(k>=0&&k<c&&F>=0&&F<u){var R=4*(k*u+F),D=t[I*o+M];w+=h[R]*D,b+=h[R+1]*D,C+=h[R+2]*D,A+=h[R+3]*D}}l[m]=r+w,l[m+1]=r+b,l[m+2]=r+C,l[m+3]=A+x*(255-A)}this.ctx.clearRect(0,0,this.width,this.height),this.ctx.putImageData(d,0,0)}return this},blur:function(t){n(void 0!==t,"Blur radius must be set.");var r=t*t,i=1/r,e=[];if(r<4)return this;for(;r--;)e.push(i);return this.convolute(e,0,!1)},sharpen:function(){return this.convolute([0,-1,0,-1,5,-1,0,-1,0],0,!1)},emboss:function(){return this.convolute([2,0,0,0,-1,0,0,0,-1],127,!1)},findEdges:function(){return this.convolute([-1,0,1,-2,0,2,-1,0,1],0,!1)}}),t.CanvasEffects=a}(window);var CanvasImage=function(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=t.width,this.height=this.canvas.height=t.height,this.context.drawImage(t,0,0,this.width,this.height)};CanvasImage.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},CanvasImage.prototype.update=function(t){this.context.putImageData(t,0,0)},CanvasImage.prototype.getPixelCount=function(){return this.width*this.height},CanvasImage.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},CanvasImage.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var ColorThief=function(){};if(window.colorThief=new ColorThief,ColorThief.prototype.getColor=function(t,r){return this.getPalette(t,5,r)[0]},ColorThief.prototype.getPalette=function(t,r,i){(void 0===r||2>r||256<r)&&(r=10),(void 0===i||1>i)&&(i=10);for(var e,n,a,o,s=(t=new CanvasImage(t)).getImageData().data,h=t.getPixelCount(),u=[],c=0;c<h;c+=i)n=s[0+(e=4*c)],a=s[e+1],o=s[e+2],125<=(e=s[e+3])&&u.push([n,a,o]);return r=(r=MMCQ.quantize(u,r))?r.palette():null,t.removeCanvas(),r},ColorThief.prototype.getColorFromUrl=function(t,r,i,e){sourceImage=document.createElement("img");var n=this;sourceImage.addEventListener("load",(function(){var t=n.getPalette(sourceImage,i,e);r(t)})),sourceImage.src=t},ColorThief.prototype.getImageData=function(t,r){xhr=new XMLHttpRequest,xhr.open("GET",t,!0),xhr.responseType="arraybuffer",xhr.onload=function(t){if(200==this.status){for(uInt8Array=new Uint8Array(this.response),t=uInt8Array.length,binaryString=Array(t),t=0;t<uInt8Array.length;t++)binaryString[t]=String.fromCharCode(uInt8Array[t]);data=binaryString.join(""),base64=window.btoa(data),r("data:image/png;base64,"+base64)}},xhr.send()},ColorThief.prototype.getColorAsync=function(t,r,i){var e=this;this.getImageData(t,(function(t){sourceImage=document.createElement("img"),sourceImage.addEventListener("load",(function(){var t=e.getPalette(sourceImage,5,i)[0];r(t,this)})),sourceImage.src=t}))},!pv)var pv={map:function(t,r){var i={};return r?t.map((function(t,e){return i.index=e,r.call(i,t)})):t.slice()},naturalOrder:function(t,r){return t<r?-1:t>r?1:0},sum:function(t,r){var i={};return t.reduce(r?function(t,e,n){return i.index=n,t+r.call(i,e)}:function(t,r){return t+r},0)},max:function(t,r){return Math.max.apply(null,r?pv.map(t,r):t)}};var MMCQ=function(){function t(t){function r(){i.sort(t),e=!0}var i=[],e=!1;return{push:function(t){i.push(t),e=!1},peek:function(t){return e||r(),void 0===t&&(t=i.length-1),i[t]},pop:function(){return e||r(),i.pop()},size:function(){return i.length},map:function(t){return i.map(t)},debug:function(){return e||r(),i}}}function r(t,r,i,e,n,a,o){this.r1=t,this.r2=r,this.g1=i,this.g2=e,this.b1=n,this.b2=a,this.histo=o}function i(){this.vboxes=new t((function(t,r){return pv.naturalOrder(t.vbox.count()*t.vbox.volume(),r.vbox.count()*r.vbox.volume())}))}function e(t,i){var e,n,a,o=1e6,s=0,h=1e6,u=0,c=1e6,f=0;return t.forEach((function(t){(e=t[0]>>3)<o?o=e:e>s&&(s=e),(n=t[1]>>3)<h?h=n:n>u&&(u=n),(a=t[2]>>3)<c?c=a:a>f&&(f=a)})),new r(o,s,h,u,c,f,i)}function n(t,r){if(r.count()){var i=r.r2-r.r1+1,e=r.g2-r.g1+1,n=pv.max([i,e,r.b2-r.b1+1]);if(1==r.count())return[r.copy()];var a,o,s,h=0,u=[],c=[];if(n==i)for(a=r.r1;a<=r.r2;a++){var f=0;for(o=r.g1;o<=r.g2;o++)for(s=r.b1;s<=r.b2;s++){var d=(a<<10)+(o<<5)+s;f+=t[d]||0}u[a]=h+=f}else if(n==e)for(a=r.g1;a<=r.g2;a++){for(f=0,o=r.r1;o<=r.r2;o++)for(s=r.b1;s<=r.b2;s++)f+=t[d=(o<<10)+(a<<5)+s]||0;u[a]=h+=f}else for(a=r.b1;a<=r.b2;a++){for(f=0,o=r.r1;o<=r.r2;o++)for(s=r.g1;s<=r.g2;s++)f+=t[d=(o<<10)+(s<<5)+a]||0;u[a]=h+=f}return u.forEach((function(t,r){c[r]=h-t})),function(t){var i=t+"1";for(t+="2",a=r[i];a<=r[t];a++)if(u[a]>h/2){var e=r.copy(),n=r.copy(),o=a-r[i],s=r[t]-a;for(o=o<=s?Math.min(r[t]-1,~~(a+s/2)):Math.max(r[i],~~(a-1-o/2));!u[o];)o++;for(s=c[o];!s&&u[o-1];)s=c[--o];return e[t]=o,n[i]=e[t]+1,[e,n]}}(n==i?"r":n==e?"g":"b")}}return r.prototype={volume:function(t){return this._volume&&!t||(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},count:function(t){var r=this.histo;if(!this._count_set||t){var i,e,n;for(t=0,i=this.r1;i<=this.r2;i++)for(e=this.g1;e<=this.g2;e++)for(n=this.b1;n<=this.b2;n++)t+=r[(i<<10)+(e<<5)+n]||0;this._count=t,this._count_set=!0}return this._count},copy:function(){return new r(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histo)},avg:function(t){var r=this.histo;if(!this._avg||t){var i,e,n,a=t=0,o=0,s=0;for(i=this.r1;i<=this.r2;i++)for(e=this.g1;e<=this.g2;e++)for(n=this.b1;n<=this.b2;n++){var h=(i<<10)+(e<<5)+n;t+=h=r[h]||0,a+=h*(i+.5)*8,o+=h*(e+.5)*8,s+=h*(n+.5)*8}this._avg=t?[~~(a/t),~~(o/t),~~(s/t)]:[~~(8*(this.r1+this.r2+1)/2),~~(8*(this.g1+this.g2+1)/2),~~(8*(this.b1+this.b2+1)/2)]}return this._avg},contains:function(t){var r=t[0]>>3;return gval=t[1]>>3,bval=t[2]>>3,r>=this.r1&&r<=this.r2&&gval>=this.g1&&gval<=this.g2&&bval>=this.b1&&bval<=this.b2}},i.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map((function(t){return t.color}))},size:function(){return this.vboxes.size()},map:function(t){for(var r=this.vboxes,i=0;i<r.size();i++)if(r.peek(i).vbox.contains(t))return r.peek(i).color;return this.nearest(t)},nearest:function(t){for(var r,i,e,n=this.vboxes,a=0;a<n.size();a++)((i=Math.sqrt(Math.pow(t[0]-n.peek(a).color[0],2)+Math.pow(t[1]-n.peek(a).color[1],2)+Math.pow(t[2]-n.peek(a).color[2],2)))<r||void 0===r)&&(r=i,e=n.peek(a).color);return e},forcebw:function(){var t=this.vboxes;t.sort((function(t,r){return pv.naturalOrder(pv.sum(t.color),pv.sum(r.color))}));var r=t[0].color;5>r[0]&&5>r[1]&&5>r[2]&&(t[0].color=[0,0,0]);var i=t[r=t.length-1].color;255<=i[0]&&255<=i[1]&&255<=i[2]&&(t[r].color=[255,255,255])}},{quantize:function(r,a){function o(t,r){for(var i,e=1,a=0;1e3>a;)if((i=t.pop()).count()){var o=n(s,i);if(i=o[0],o=o[1],!i)break;if(t.push(i),o&&(t.push(o),e++),e>=r)break;if(1e3<a++)break}else t.push(i),a++}if(!r.length||2>a||256<a)return!1;var s=function(t){var r,i=Array(32768);return t.forEach((function(t){i[r=(t[0]>>3<<10)+(t[1]>>3<<5)+(t[2]>>3)]=(i[r]||0)+1})),i}(r);s.forEach((function(){}));var h=e(r,s),u=new t((function(t,r){return pv.naturalOrder(t.count(),r.count())}));for(u.push(h),o(u,.75*a),h=new t((function(t,r){return pv.naturalOrder(t.count()*t.volume(),r.count()*r.volume())}));u.size();)h.push(u.pop());for(o(h,a-h.size()),u=new i;h.size();)u.push(h.pop());return u}}}();window.core=function(){function t(t,r){this.x=t,this.y=r}function r(t,r){this.w=t,this.h=r,this.size=t*r,this.arraybuffer=new ArrayBuffer(this.size),this.data=new Int8Array(this.arraybuffer)}function i(){this.len=this.area=0,this.curve={},this.pt=[],this.minY=this.minX=1e5,this.maxY=this.maxX=-1}function e(t){this.n=t,this.tag=Array(t),this.c=Array(3*t),this.alphaCurve=0,this.vertex=Array(t),this.alpha=Array(t),this.alpha0=Array(t),this.beta=Array(t)}function n(){u=null,c=[],o=null,f.isReady=!1}var a=!1;["/oi.buhtig.cevnoc//:sptth","0024:tsohlacol//:ptth"].forEach((function(t){-1!==window.parent.location.href.indexOf(t.split("").reverse().join(""))&&(a=!0)})),a?a=!0:window.location.replace("/oi.buhtig.cevnoc//:sptth".split("").reverse().join("")),t.prototype.copy=function(){return new t(this.x,this.y)},r.prototype.at=function(t,r){return 0<=t&&t<this.w&&0<=r&&r<this.h&&1===this.data[this.w*r+t]},r.prototype.index=function(r){var i=new t;return i.y=Math.floor(r/this.w),i.x=r-i.y*this.w,i},r.prototype.flip=function(t,r){this.data[this.w*r+t]=this.at(t,r)?0:1},r.prototype.copy=function(){var t,i=new r(this.w,this.h);for(t=0;t<this.size;t++)i.data[t]=this.data[t];return i};var o,s=document.createElement("img"),h=document.createElement("canvas"),u=null,c=[],f={isReady:!1,turnpolicy:"minority",turdsize:5,optcurve:!0,alphamax:1,opttolerance:1};return s.onload=function(){var t;t=s.width/s.height,h.width=s.width,h.height=s.height,800<h.width&&(h.width=800,h.height=800/t),800<h.height&&(h.height=800,h.width=800*t),(t=h.getContext("2d")).fillStyle="#ffffff",t.fillRect(0,0,h.width,h.height),t.drawImage(s,0,0,h.width,h.height),function(){var t=h.getContext("2d");u=new r(h.width,h.height);var i,e=t.getImageData(0,0,u.w,u.h),n=e.data.length;for(i=t=0;t<n;t+=4,i++)u.data[i]=128>.2126*e.data[t]+.7153*e.data[t+1]+.0721*e.data[t+2]?1:0;f.isReady=!0}()},{loadImageFromFile:function(t){f.isReady&&n(),s.file=t;var r=new FileReader;r.onload=function(t){s.src=t.target.result},r.readAsDataURL(t)},loadImageFromUrl:function(t){f.isReady&&n(),s.src=t},setParameter:function(t){for(var r in t)t.hasOwnProperty(r)&&(f[r]=t[r])},loadFromCanvas:function(t){f.isReady&&n(),h.width=t.width,h.height=t.height;var i=h.getContext("2d");i.clearRect(0,0,h.width,h.height),i.drawImage(t,0,0,h.width,h.height),u=new r(h.width,h.height);var e=i.getImageData(0,0,u.w,u.h),a=e.data.length;for(i=t=0;t<a;t+=4,i++)0<e.data[t+3]&&(u.data[i]=128>.2126*e.data[t]+.7153*e.data[t+1]+.0721*e.data[t+2]?1:0);f.isReady=!0},process:function r(n){n&&(o=n),f.isReady?(function(){function r(t,r){var i,e;for(i=2;5>i;i++){var a=0;for(e=1-i;e<=i-1;e++)a+=n.at(t+e,r+i-1)?1:-1,a+=n.at(t+i-1,r+e-1)?1:-1,a+=n.at(t+e-1,r-i)?1:-1,a+=n.at(t-i,r+e)?1:-1;if(0<a)return 1;if(0>a)break}return 0}for(var e,n=u.copy(),a=new t(0,0);a=function(t){for(t=n.w*t.y+t.x;t<n.size&&1!==n.data[t];)t++;return t<n.size&&n.index(t)}(a);)(function(t){var r,i,e,a=t.pt[0].y,o=t.len;for(e=1;e<o;e++)if(r=t.pt[e].x,(i=t.pt[e].y)!==a){var s=a<i?a:i;for(a=t.maxX;r<a;r++)n.flip(r,s);a=i}})(e=function(e){var a,o=new i,s=e.x,h=e.y,c=0,d=1;for(o.sign=u.at(e.x,e.y)?"+":"-";o.pt.push(new t(s,h)),s>o.maxX&&(o.maxX=s),s<o.minX&&(o.minX=s),h>o.maxY&&(o.maxY=h),h<o.minY&&(o.minY=h),o.len++,h+=d,o.area-=(s+=c)*d,s!==e.x||h!==e.y;){var l=n.at(s+(c+d-1)/2,h+(d-c-1)/2),x=n.at(s+(c-d-1)/2,h+(d+c-1)/2);x&&!l?"right"===f.turnpolicy||"black"===f.turnpolicy&&"+"===o.sign||"white"===f.turnpolicy&&"-"===o.sign||"majority"===f.turnpolicy&&r(s,h)||"minority"===f.turnpolicy&&!r(s,h)?(a=c,c=-d,d=a):(a=c,c=d,d=-a):x?(a=c,c=-d,d=a):l||(a=c,c=d,d=-a)}return o}(a)),e.area>f.turdsize&&c.push(e)}(),function(){function r(){this.data=[0,0,0,0,0,0,0,0,0]}function i(t,r,i,e,n){this.x=t,this.y=r,this.xy=i,this.x2=e,this.y2=n}function n(t,r){return t>=r?t%r:0<=t?t:r-1-(-1-t)%r}function a(t,r){return t.x*r.y-t.y*r.x}function o(t,r,i){return t<=i?t<=r&&r<i:t<=r||r<i}function s(t){return 0<t?1:0>t?-1:0}function h(t,r){var i,e,n,a=Array(3);for(a[0]=r.x,a[1]=r.y,a[2]=1,i=n=0;3>i;i++)for(e=0;3>e;e++)n+=a[i]*t.at(i,e)*a[e];return n}function u(r,i,e){var n=new t;return n.x=i.x+r*(e.x-i.x),n.y=i.y+r*(e.y-i.y),n}function d(t,r,i){return(r.x-t.x)*(i.y-t.y)-(i.x-t.x)*(r.y-t.y)}function l(t,r,i,e){return(r.x-t.x)*(e.y-i.y)-(e.x-i.x)*(r.y-t.y)}function x(t,r,i){return(r.x-t.x)*(i.x-t.x)+(r.y-t.y)*(i.y-t.y)}function v(t,r){return Math.sqrt((t.x-r.x)*(t.x-r.x)+(t.y-r.y)*(t.y-r.y))}function g(r,i,e,n,a){var o=1-r,s=new t;return s.x=o*o*o*i.x+o*o*r*3*e.x+r*r*o*3*n.x+r*r*r*a.x,s.y=o*o*o*i.y+o*o*r*3*e.y+r*r*o*3*n.y+r*r*r*a.y,s}function p(t,r,i,e,n,a){var o,s,h,u,c,f,d,x;return c=(u=-2*(o=l(t,r,n,a))+2*(s=l(r,i,n,a)))*u-4*(h=o-2*s+l(i,e,n,a))*o,0===h||0>c?-1:(x=(-u-(f=Math.sqrt(c)))/(2*h),0<=(d=(-u+f)/(2*h))&&1>=d?d:0<=x&&1>=x?x:-1)}r.prototype.at=function(t,r){return this.data[3*t+r]};for(var y=0;y<c.length;y++){var m=c[y];!function(t){var r;t.x0=t.pt[0].x,t.y0=t.pt[0].y,t.sums=[];var e=t.sums;for(e.push(new i(0,0,0,0,0)),r=0;r<t.len;r++){var n=t.pt[r].x-t.x0,a=t.pt[r].y-t.y0;e.push(new i(e[r].x+n,e[r].y+a,e[r].xy+n*a,e[r].x2+n*n,e[r].y2+a*a))}}(m),function(r){var i=r.len,e=r.pt,h=Array(i),u=Array(i),c=Array(4);r.lon=Array(i);var f,d,l,x,v,g,p,y,m=[new t,new t],w=new t,b=new t,C=new t,A=0;for(d=i-1;0<=d;d--)e[d].x!=e[A].x&&e[d].y!=e[A].y&&(A=d+1),u[d]=A;for(d=i-1;0<=d;d--){for(c[0]=c[1]=c[2]=c[3]=0,c[(3+3*(e[n(d+1,i)].x-e[d].x)+(e[n(d+1,i)].y-e[d].y))/2]++,m[0].x=0,m[0].y=0,m[1].x=0,m[1].y=0,A=u[d],x=d;;){if(f=0,c[(3+3*s(e[A].x-e[x].x)+s(e[A].y-e[x].y))/2]++,c[0]&&c[1]&&c[2]&&c[3]){h[d]=x,f=1;break}if(w.x=e[A].x-e[d].x,w.y=e[A].y-e[d].y,0>a(m[0],w)||0<a(m[1],w))break;if(1>=Math.abs(w.x)&&1>=Math.abs(w.y)||(b.x=w.x+(0<=w.y&&(0<w.y||0>w.x)?1:-1),b.y=w.y+(0>=w.x&&(0>w.x||0>w.y)?1:-1),0<=a(m[0],b)&&(m[0].x=b.x,m[0].y=b.y),b.x=w.x+(0>=w.y&&(0>w.y||0>w.x)?1:-1),b.y=w.y+(0<=w.x&&(0<w.x||0>w.y)?1:-1),0>=a(m[1],b)&&(m[1].x=b.x,m[1].y=b.y)),!o(A=u[x=A],d,x))break}0===f&&(C.x=s(e[A].x-e[x].x),C.y=s(e[A].y-e[x].y),w.x=e[x].x-e[d].x,w.y=e[x].y-e[d].y,v=a(m[0],w),g=a(m[0],C),p=a(m[1],w),y=a(m[1],C),l=1e7,0>g&&(l=Math.floor(v/-g)),0<y&&(l=Math.min(l,Math.floor(-p/y))),h[d]=n(x+l,i))}for(r.lon[i-1]=l=h[i-1],d=i-2;0<=d;d--)o(d+1,h[d],l)&&(l=h[d]),r.lon[d]=l;for(d=i-1;o(n(d+1,i),l,r.lon[d]);d--)r.lon[d]=l}(m),function(t){var r,i,e,a,o,s,h,u,c,f=t.len,d=Array(f+1),l=Array(f+1),x=Array(f),v=Array(f+1),g=Array(f+1),p=Array(f+1);for(r=0;r<f;r++)(i=n(t.lon[n(r-1,f)]-1,f))==r&&(i=n(r+1,f)),x[r]=i<r?f:i;for(i=1,r=0;r<f;r++)for(;i<=x[r];)v[i]=r,i++;for(i=r=0;r<f;i++)g[i]=r,r=x[r];for(r=g[i]=f,i=x=i;0<i;i--)p[i]=r,r=v[r];for(p[0]=0,d[0]=0,i=1;i<=x;i++)for(r=p[i];r<=g[i];r++){var y=-1;for(e=g[i-1];e>=v[r];e--){var m=t,w=e,b=r,C=c=u=h=s=o=a=void 0,A=m.len,I=m.pt;m=m.sums;var M=0;b>=A&&(b-=A,M=1),0===M?(a=m[b+1].x-m[w].x,o=m[b+1].y-m[w].y,h=m[b+1].x2-m[w].x2,s=m[b+1].xy-m[w].xy,u=m[b+1].y2-m[w].y2,c=b+1-w):(a=m[b+1].x-m[w].x+m[A].x,o=m[b+1].y-m[w].y+m[A].y,h=m[b+1].x2-m[w].x2+m[A].x2,s=m[b+1].xy-m[w].xy+m[A].xy,u=m[b+1].y2-m[w].y2+m[A].y2,c=b+1-w+A),w=(C=-(I[b].y-I[w].y))*C*((h-2*a*(A=(I[w].x+I[b].x)/2-I[0].x))/c+A*A)+2*C*(M=I[b].x-I[w].x)*((s-a*(m=(I[w].y+I[b].y)/2-I[0].y)-o*A)/c+A*m)+M*M*((u-2*o*m)/c+m*m),C=Math.sqrt(w)+d[e],(0>y||C<y)&&(l[r]=e,y=C)}d[r]=y}for(t.m=x,t.po=Array(x),r=f,i=x-1;0<r;i--)t.po[i]=r=l[r]}(m),function(i){var a,o,s,u,c=i.m,f=i.po,d=i.len,l=i.pt,x=i.x0,v=i.y0,g=Array(c),p=Array(c),y=Array(c),m=Array(3),w=new t;for(i.curve=new e(c),a=0;a<c;a++){var b=n((b=f[n(a+1,c)])-f[a],d)+f[a];g[a]=new t,p[a]=new t;var C=o=void 0,A=f[a],I=b,M=g[a];b=p[a];for(var k=i.len,F=i.sums,R=0;I>=k;)I-=k,R+=1;for(;A>=k;)A-=k,--R;for(;0>I;)I+=k,--R;for(;0>A;)A+=k,R+=1;var D=F[I+1].x-F[A].x+R*F[k].x,E=F[I+1].y-F[A].y+R*F[k].y,S=F[I+1].x2-F[A].x2+R*F[k].x2,G=F[I+1].xy-F[A].xy+R*F[k].xy;F=F[I+1].y2-F[A].y2+R*F[k].y2,M.x=D/(A=I+1-A+R*k),M.y=E/A,S=(S-D*D/A)/A,G=(G-D*E/A)/A,S-=E=(S+(C=(F-E*E/A)/A)+Math.sqrt((S-C)*(S-C)+4*G*G))/2,C-=E,Math.abs(S)>=Math.abs(C)?0!==(o=Math.sqrt(S*S+G*G))&&(b.x=-G/o,b.y=S/o):0!==(o=Math.sqrt(C*C+G*G))&&(b.x=-C/o,b.y=G/o),0===o&&(b.x=b.y=0)}for(a=0;a<c;a++)if(y[a]=new r,0==(C=p[a].x*p[a].x+p[a].y*p[a].y))for(b=0;3>b;b++)for(d=0;3>d;d++)y[a].data[3*b+d]=0;else for(m[0]=p[a].y,m[1]=-p[a].x,m[2]=-m[1]*g[a].y-m[0]*g[a].x,o=0;3>o;o++)for(d=0;3>d;d++)y[a].data[3*o+d]=m[o]*m[d]/C;for(a=0;a<c;a++){for(g=new r,p=new t,w.x=l[f[a]].x-x,w.y=l[f[a]].y-v,b=n(a-1,c),o=0;3>o;o++)for(d=0;3>d;d++)g.data[3*o+d]=y[b].at(o,d)+y[a].at(o,d);for(;;){if(0!=(d=g.at(0,0)*g.at(1,1)-g.at(0,1)*g.at(1,0))){p.x=(-g.at(0,2)*g.at(1,1)+g.at(1,2)*g.at(0,1))/d,p.y=(g.at(0,2)*g.at(1,0)-g.at(1,2)*g.at(0,0))/d;break}for(g.at(0,0)>g.at(1,1)?(m[0]=-g.at(0,1),m[1]=g.at(0,0)):g.at(1,1)?(m[0]=-g.at(1,1),m[1]=g.at(1,0)):(m[0]=1,m[1]=0),C=m[0]*m[0]+m[1]*m[1],m[2]=-m[1]*w.y-m[0]*w.x,o=0;3>o;o++)for(d=0;3>d;d++)g.data[3*o+d]+=m[o]*m[d]/C}if(s=Math.abs(p.x-w.x),u=Math.abs(p.y-w.y),.5>=s&&.5>=u)i.curve.vertex[a]=new t(p.x+x,p.y+v);else{if(C=h(g,w),b=w.x,E=w.y,0!==g.at(0,0))for(d=0;2>d;d++){p.y=w.y-.5+d,p.x=-(g.at(0,1)*p.y+g.at(0,2))/g.at(0,0),s=Math.abs(p.x-w.x);var U=h(g,p);.5>=s&&U<C&&(C=U,b=p.x,E=p.y)}if(0!==g.at(1,1))for(d=0;2>d;d++)p.x=w.x-.5+d,p.y=-(g.at(1,0)*p.x+g.at(1,2))/g.at(1,1),u=Math.abs(p.y-w.y),U=h(g,p),.5>=u&&U<C&&(C=U,b=p.x,E=p.y);for(o=0;2>o;o++)for(d=0;2>d;d++)p.x=w.x-.5+o,p.y=w.y-.5+d,(U=h(g,p))<C&&(C=U,b=p.x,E=p.y);i.curve.vertex[a]=new t(b+x,E+v)}}}(m),"-"===m.sign&&function(t){var r=(t=m.curve).n,i=t.vertex;for(t=0,--r;t<r;t++,r--){var e=i[t];i[t]=i[r],i[r]=e}}(),function(r){var i,e,a,o,h,c=r.curve.n,l=r.curve;for(r=0;r<c;r++){var x,v,g=n(r+1,c),p=n(r+2,c),y=u(.5,l.vertex[p],l.vertex[g]),m=void 0,w=l.vertex[r],b=l.vertex[p],C=(v=w,x=b,(m=new t).y=s(x.x-v.x),m.x=-s(x.y-v.y),m);0!=(e=C.y*(b.x-w.x)-C.x*(b.y-w.y))?(i=d(l.vertex[r],l.vertex[g],l.vertex[p])/e,a=1<(i=Math.abs(i))?1-1/i:0,a/=.75):a=4/3,l.alpha0[g]=a,a>=f.alphamax?(l.tag[g]="CORNER",l.c[3*g+1]=l.vertex[g],l.c[3*g+2]=y):(.55>a?a=.55:1<a&&(a=1),o=u(.5+.5*a,l.vertex[r],l.vertex[g]),h=u(.5+.5*a,l.vertex[p],l.vertex[g]),l.tag[g]="CURVE",l.c[3*g]=o,l.c[3*g+1]=h,l.c[3*g+2]=y),l.alpha[g]=a,l.beta[g]=.5}l.alphacurve=1}(m),f.optcurve&&function(r){function i(){this.pen=0,this.c=[new t,new t],this.alpha=this.s=this.t=0}var a,o,h=r.curve,c=h.n,y=h.vertex,m=Array(c+1),w=Array(c+1),b=Array(c+1),C=Array(c+1),A=new i,I=Array(c),M=Array(c+1);for(a=0;a<c;a++)I[a]="CURVE"==h.tag[a]?s(d(y[n(a-1,c)],y[a],y[n(a+1,c)])):0;var k=0;M[0]=0;var F=h.vertex[0];for(a=0;a<c;a++){var R=n(a+1,c);"CURVE"==h.tag[R]&&(k+=.3*(o=h.alpha[R])*(4-o)*d(h.c[3*a+2],y[R],h.c[3*R+2])/2,k+=d(F,h.c[3*a+2],h.c[3*R+2])/2),M[a+1]=k}for(m[0]=-1,w[0]=0,b[0]=0,R=1;R<=c;R++)for(m[R]=R-1,w[R]=w[R-1],b[R]=b[R-1]+1,a=R-2;0<=a&&!function(t,r,i,e,a,o,h){var c,f,y,m,w,b,C,A,I,M,k,F,R,D,E,S,G,U,q,L,P,z,O,_,B=t.curve.n,T=t.curve,H=T.vertex;if(r==i||(c=r,w=n(r+1,B),0===(m=o[f=n(c+1,B)])))return 1;for(t=v(H[r],H[w]),c=f;c!=i;c=f)if(f=n(c+1,B),y=n(c+2,B),o[f]!=m||s(l(H[r],H[w],H[f],H[y]))!=m||((z=H[w]).x-(P=H[r]).x)*((_=H[y]).x-(O=H[f]).x)+(z.y-P.y)*(_.y-O.y)<t*v(H[f],H[y])*-.999847695156)return 1;if(I=T.c[3*n(r,B)+2].copy(),M=H[n(r+1,B)].copy(),k=H[n(i,B)].copy(),F=T.c[3*n(i,B)+2].copy(),b=h[i]-h[r],b-=d(H[0],T.c[3*r+2],T.c[3*i+2])/2,r>=i&&(b+=h[B]),E=d(I,M,k),S=d(I,M,F),U=E+(G=d(I,k,F))-S,S==E||(q=S/(S-E),0==(D=S*(L=G/(G-U))/2)))return 1;for(o=2-Math.sqrt(4-b/D/.3),e.c[0]=u(L*o,I,M),e.c[1]=u(q*o,F,k),e.alpha=o,e.t=L,e.s=q,M=e.c[0].copy(),k=e.c[1].copy(),e.pen=0,c=n(r+1,B);c!=i;c=f){if(f=n(c+1,B),-.5>(L=p(I,M,k,F,H[c],H[f]))||(R=g(L,I,M,k,F),0===(t=v(H[c],H[f])))||(C=d(H[c],H[f],R)/t,Math.abs(C)>a)||0>x(H[c],H[f],R)||0>x(H[f],H[c],R))return 1;e.pen+=C*C}for(c=r;c!=i;c=f){if(f=n(c+1,B),-.5>(L=p(I,M,k,F,T.c[3*c+2],T.c[3*f+2]))||(R=g(L,I,M,k,F),0===(t=v(T.c[3*c+2],T.c[3*f+2])))||(C=d(T.c[3*c+2],T.c[3*f+2],R)/t,A=d(T.c[3*c+2],T.c[3*f+2],H[f])/t,0>(A*=.75*T.alpha[f])&&(C=-C,A=-A),C<A-a))return 1;C<A&&(e.pen+=(C-A)*(C-A))}return 0}(r,a,n(R,c),A,f.opttolerance,I,M);a--)(b[R]>b[a]+1||b[R]==b[a]+1&&w[R]>w[a]+A.pen)&&(m[R]=a,w[R]=w[a]+A.pen,b[R]=b[a]+1,C[R]=A,A=new i);for(b=new e(w=b[c]),A=Array(w),I=Array(w),R=c,a=w-1;0<=a;a--)m[R]==R-1?(b.tag[a]=h.tag[n(R,c)],b.c[3*a]=h.c[3*n(R,c)],b.c[3*a+1]=h.c[3*n(R,c)+1],b.c[3*a+2]=h.c[3*n(R,c)+2],b.vertex[a]=h.vertex[n(R,c)],b.alpha[a]=h.alpha[n(R,c)],b.alpha0[a]=h.alpha0[n(R,c)],b.beta[a]=h.beta[n(R,c)],A[a]=I[a]=1):(b.tag[a]="CURVE",b.c[3*a]=C[R].c[0],b.c[3*a+1]=C[R].c[1],b.c[3*a+2]=h.c[3*n(R,c)+2],b.vertex[a]=u(C[R].s,h.c[3*n(R,c)+2],y[n(R,c)]),b.alpha[a]=C[R].alpha,b.alpha0[a]=C[R].alpha,A[a]=C[R].s,I[a]=C[R].t),R=m[R];for(a=0;a<w;a++)R=n(a+1,w),b.beta[a]=A[a]/(A[a]+I[R]);b.alphacurve=1,r.curve=b}(m)}}(),o(),o=null):setTimeout((function(){r(n)}),100)},getSVG:function(t,r,i){var e,n,a,o,s=c.length,h='<svg id="svg" version="1.1" width="'+u.w*t+'" height="'+u.h*t+'" xmlns="http://www.w3.org/2000/svg">';for(h+='<path d="',e=0;e<s;e++){var f,d=void 0,l=void 0,x=void 0,v=c[e].curve,g=v.n,p="M"+(v.c[3*(g-1)+2].x*t).toFixed(3)+" "+(v.c[3*(g-1)+2].y*t).toFixed(3)+" ";for(f=0;f<g;f++)"CURVE"===v.tag[f]?p+=(d=void 0,d="C "+(v.c[3*(l=f)].x*t).toFixed(3)+" "+(v.c[3*l].y*t).toFixed(3)+",",(d+=(v.c[3*l+1].x*t).toFixed(3)+" "+(v.c[3*l+1].y*t).toFixed(3)+",")+(v.c[3*l+2].x*t).toFixed(3)+" "+(v.c[3*l+2].y*t).toFixed(3)+" "):"CORNER"===v.tag[f]&&(p+="L "+(v.c[3*(x=f)+1].x*t).toFixed(3)+" "+(v.c[3*x+1].y*t).toFixed(3)+" "+(v.c[3*x+2].x*t).toFixed(3)+" "+(v.c[3*x+2].y*t).toFixed(3)+" ");h+=p}return"curve"===r?(n="black",a="none",o=""):(n="none",a=i,o=' fill-rule="evenodd"'),h+'" stroke="'+n+'" fill="'+a+'"'+o+"/></svg>"},getPath:function(t,r,i,e){var n,a,o,s,h=c.length,u='<path d="';for(n=0;n<h;n++){var f,d=void 0,l=void 0,x=void 0,v=c[n].curve,g=v.n,p="M"+(v.c[3*(g-1)+2].x*t).toFixed(3)+" "+(v.c[3*(g-1)+2].y*t).toFixed(3)+" ";for(f=0;f<g;f++)"CURVE"===v.tag[f]?p+=(d=void 0,d="C "+(v.c[3*(l=f)].x*t).toFixed(3)+" "+(v.c[3*l].y*t).toFixed(3)+",",(d+=(v.c[3*l+1].x*t).toFixed(3)+" "+(v.c[3*l+1].y*t).toFixed(3)+",")+(v.c[3*l+2].x*t).toFixed(3)+" "+(v.c[3*l+2].y*t).toFixed(3)+" "):"CORNER"===v.tag[f]&&(p+="L "+(v.c[3*(x=f)+1].x*t).toFixed(3)+" "+(v.c[3*x+1].y*t).toFixed(3)+" "+(v.c[3*x+2].x*t).toFixed(3)+" "+(v.c[3*x+2].y*t).toFixed(3)+" ");u+=p}return"curve"===r?(a="black",o="none",s=""):(a="none",o=i,s=' fill-rule="evenodd"'),u+='" stroke="'+a+'" fill="'+o+'"'+s+"/>",e&&(u=u.replace("<path d",'<path id="'+e+'" d')),u},getPathd:function(t,r,i){i=c.length;var e="";for(r=0;r<i;r++){var n,a=void 0,o=void 0,s=void 0,h=c[r].curve,u=h.n,f="M"+(h.c[3*(u-1)+2].x*t).toFixed(3)+" "+(h.c[3*(u-1)+2].y*t).toFixed(3)+" ";for(n=0;n<u;n++)"CURVE"===h.tag[n]?f+=(a=void 0,a="C "+(h.c[3*(o=n)].x*t).toFixed(3)+" "+(h.c[3*o].y*t).toFixed(3)+",",(a+=(h.c[3*o+1].x*t).toFixed(3)+" "+(h.c[3*o+1].y*t).toFixed(3)+",")+(h.c[3*o+2].x*t).toFixed(3)+" "+(h.c[3*o+2].y*t).toFixed(3)+" "):"CORNER"===h.tag[n]&&(f+="L "+(h.c[3*(s=n)+1].x*t).toFixed(3)+" "+(h.c[3*s+1].y*t).toFixed(3)+" "+(h.c[3*s+2].x*t).toFixed(3)+" "+(h.c[3*s+2].y*t).toFixed(3)+" ");e+=f}return e},img:s}}(),(function(){function t(t){if(this.method=(t=t||{}).method||2,this.colors=t.colors||256,this.width=1e3,this.height=1e3,this.blur=t.blur||0,this.initColors=t.initColors||4096,this.initDist=t.initDist||.02,this.distIncr=t.distIncr||.01,this.hueGroups=t.hueGroups||1,this.satGroups=t.satGroups||1,this.lumGroups=t.lumGroups||1,this.minHueCols=t.minHueCols||1,this.hueStats=this.minHueCols?new i(this.hueGroups,this.minHueCols):null,this.boxSize=t.boxSize||[64,64],this.boxPxls=t.boxPxls||1,this.palLocked=!1,this.dithKern=t.ditherKern||null,this.dithSerp=t.dithSerp||!1,this.dithDelta=t.dithDelta||0,this.histogram={},this.idxrgb=t.palette?t.palette.slice(0):[],this.idxi32=[],this.i32idx={},this.i32rgb={},this.idxhex=[],this.useCache=!1!==t.useCache,this.cacheFreq=t.cacheFreq||10,this.reIndex=t.reIndex||0==this.idxrgb.length,this.colorDist="manhattan"==t.colorDist?n:e,this.averageRGB={r:255,g:255,b:255},0<this.idxrgb.length){var a=this;this.idxrgb.forEach((function(t,i){var e,n,o=(-16777216|t[2]<<16|t[1]<<8|t[0])>>>0;a.idxi32[i]=o,a.i32idx[o]=i,a.i32rgb[o]=t,a.idxhex[i]=(e=t[1],n=t[2],r(t[0])+r(e)+r(n))}))}}function r(t){return 1==(t=t.toString(16)).length?"0"+t:t}function i(t,r){this.numGroups=t,this.minCols=r,this.stats={};for(var i=-1;i<t;i++)this.stats[i]={num:0,cols:[]};this.groupsFull=0}function e(t,r){var i=r[0]-t[0],e=r[1]-t[1],n=r[2]-t[2],a=this.averageRGB.r+this.averageRGB.g+this.averageRGB.b;return l||(l=(this.averageRGB.r/a).toFixed(3),x=(this.averageRGB.g/a).toFixed(3),v=(this.averageRGB.b/a).toFixed(3)),d||(d=Math.sqrt(65025*l+65025*x+65025*v)),Math.sqrt(l*i*i+x*e*e+v*n*n)/d}function n(t,r){return(g*Math.abs(r[0]-t[0])+p*Math.abs(r[1]-t[1])+y*Math.abs(r[2]-t[2]))/m}function a(t,r,i){var e,n,a,o,s,h,u;if(t/=255,r/=255,i/=255,a=((e=Math.max(t,r,i))+(n=Math.min(t,r,i)))/2,e==n)var c=n=0;else{switch(o=e-n,n=.5<a?o/(2-e-n):o/(e+n),e){case t:c=(r-i)/o+(r<i?6:0);break;case r:c=(i-t)/o+2;break;case i:c=(t-r)/o+4}c/=6}return{h:c,s:n,l:(s=t,h=r,u=i,l?Math.sqrt(l*s*s+x*h*h+v*u*u):Math.sqrt(g*s*s+p*h*h+y*u*u))}}function o(t,r){var i=1/r,e=i/2;if(t>=1-e||t<=e)return 0;for(var n=1;n<r;n++){var a=n*i;if(t>=a-e&&t<=a+e)return n}}function s(t){return Object.prototype.toString.call(t).slice(8,-1)}function h(t,r,i){var e,n;switch(i&&(n=i.blur),s(t)){case"HTMLImageElement":window.MAX_VALUE=2400,(e=document.createElement("canvas")).width=t.naturalWidth,e.height=t.naturalHeight,r=e.width/e.height,1e3>e.width&&(e.width=1e3,e.height=1e3/r),1e3>e.height&&(e.width=1e3*r,e.height=1e3),e.width>window.MAX_VALUE&&(e.width=window.MAX_VALUE,e.height=window.MAX_VALUE/r),e.height>window.MAX_VALUE&&(e.width=window.MAX_VALUE*r,e.height=window.MAX_VALUE);var a=e.getContext("2d");null!=i&&(i.width=e.width,i.height=e.height),a.drawImage(t,0,0,t.naturalWidth,t.naturalHeight,0,0,e.width,e.height),a.filter="blur("+n+"px)",u(a.getImageData(0,0,e.width,e.height)),a.drawImage(t,0,0,e.width,e.height);var o=u(a.getImageData(0,0,e.width,e.height));case"Canvas":case"HTMLCanvasElement":e=e||t,a=a||e.getContext("2d");case"CanvasRenderingContext2D":var h=(a=a||t).getImageData(0,0,(e=e||a.canvas).width,e.height);case"ImageData":r=(h=h||t).width;var c="CanvasPixelArray"==s(h.data)?new Uint8Array(h.data):h.data;case"Array":case"CanvasPixelArray":c=c||new Uint8Array(t);case"Uint8Array":case"Uint8ClampedArray":c=c||t;var f=new Uint32Array(c.buffer);case"Uint32Array":f=f||t,c=c||new Uint8Array(f.buffer);var d=f.length/(r=r||f.length)}return{can:e,ctx:a,imgd:h,buf8:c,buf32:f,width:r,height:d,avgRGB:o}}function u(t){for(var r=0;(r+=4*A)<t.data.length;)++b,C.r+=t.data[r],C.g+=t.data[r+1],C.b+=t.data[r+2];return C.r=~~(C.r/b),C.g=~~(C.g/b),C.b=~~(C.b/b),b=0,C}var c,f;t.prototype.sample=function(t,r,i,e,n){if(this.palLocked)throw"Cannot sample additional images, palette already assembled.";if(c=h(t,r,this),this.averageRGB=c.avgRGB,e)n(i);else switch(this.method){case 1:this.colorStats1D(c.buf32,n);break;case 2:this.colorStats2D(c.buf32,c.width)}},t.prototype.reduce=function(t,r,i,e){if(this.palLocked||this.buildPal(),e=void 0!==e?e:this.dithSerp,r=r||1,i=i||this.dithKern)o=this.dither(t,i,e);else{var n=h(t,null,this).buf32,a=n.length,o=new Uint32Array(a),s=0;!function t(r){for(;s<a;s++)o[s]=r.nearestColor(n[s]),s+1<a&&0==s%8e3&&setTimeout(t,0)}(this)}if(this.reduceOut32=o,1==r)return new Uint8Array(o.buffer);if(2==r){for(t=[],a=o.length,s=0;s<a;s++)t[s]=this.i32idx[o[s]];return t}},t.prototype.replaceColor=function(t,r){for(var i=(r.b<<16)-16777216+(r.g<<8)+r.r,e=this.reduceOut32[0],n=0;n<this.reduceOut32.length;n++)this.reduceOut32[n]==e&&(this.reduceOut32[n]=i);return new Uint8Array(this.reduceOut32.buffer)},t.prototype.dither=function(t,r,i){var e={FloydSteinberg:[[.4375,1,0],[.1875,-1,1],[.3125,0,1],[.0625,1,1]],FalseFloydSteinberg:[[.375,1,0],[.375,0,1],[.25,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[.125,1,0],[.125,2,0],[.125,-1,1],[.125,0,1],[.125,1,1],[.125,0,2]],Jarvis:[[7/48,1,0],[5/48,2,0],[.0625,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[.0625,2,1],[1/48,-2,2],[.0625,-1,2],[5/48,0,2],[.0625,1,2],[1/48,2,2]],Burkes:[[.25,1,0],[.125,2,0],[.0625,-2,1],[.125,-1,1],[.25,0,1],[.125,1,1],[.0625,2,1]],Sierra:[[.15625,1,0],[.09375,2,0],[.0625,-2,1],[.125,-1,1],[.15625,0,1],[.125,1,1],[.0625,2,1],[.0625,-1,2],[.09375,0,2],[.0625,1,2]],TwoSierra:[[.25,1,0],[.1875,2,0],[.0625,-2,1],[.125,-1,1],[.1875,0,1],[.125,1,1],[.0625,2,1]],SierraLite:[[.5,1,0],[.25,-1,1],[.25,0,1]]};if(!r||!e[r])throw"Unknown dithering kernel: "+r;r=e[r];var n=h(t,null,this);t=n.buf32,e=n.width,n=n.height;for(var a=i?-1:1,o=0;o<n;o++){i&&(a*=-1);for(var s=o*e,u=1==a?0:e-1,c=1==a?e:0;u!==c;u+=a){var f=s+u,d=t[f],l=255&d,x=(65280&d)>>8,v=(16711680&d)>>16,g=this.nearestColor(d),p=255&g;if(d=(65280&g)>>8,t[f]=-16777216|(g=(16711680&g)>>16)<<16|d<<8|p,!(this.dithDelta&&this.colorDist([l,x,v],[p,d,g])<this.dithDelta))for(l-=p,x-=d,v-=g,d=1==a?0:r.length-1,g=1==a?r.length:0;d!==g;d+=a){var y=r[d][2],m=y*e;0<=(p=r[d][1]*a)+u&&p+u<e&&0<=y+o&&y+o<n&&(y=r[d][0],t[p=f+(m+p)]=-16777216|Math.max(0,Math.min(255,((16711680&t[p])>>16)+v*y))<<16|Math.max(0,Math.min(255,((65280&t[p])>>8)+x*y))<<8|Math.max(0,Math.min(255,(255&t[p])+l*y)))}}}return t},t.prototype.buildPal=function(t){if(!(this.palLocked||0<this.idxrgb.length&&this.idxrgb.length<=this.colors)){var r=this.histogram,i=function(t,r){var i,e=[];for(i in t)e.push(i);return w.call(e,(function(r,i){return t[i]-t[r]}))}(r);if(0==i.length)throw"Nothing has been sampled, palette cannot be built.";switch(this.method){case 1:for(var e=this.initColors,n=r[i[e-1]],a=i.slice(0,e),o=i.length;e<o&&r[i[e]]==n;)a.push(i[e++]);this.hueStats&&this.hueStats.inject(a);break;case 2:a=i}a=a.map((function(t){return+t})),this.reducePal(a),!t&&this.reIndex&&this.sortPal(),this.useCache&&this.cacheHistogram(a),this.palLocked=!0}},t.prototype.palette=function(t,r,i){return i&&(this.histogram=i),this.buildPal(r),t?this.idxrgb:new Uint8Array(new Uint32Array(this.idxi32).buffer)},t.prototype.prunePal=function(t){for(var r,i=0;i<this.idxrgb.length;i++)t[i]||(r=this.idxi32[i],this.idxrgb[i]=null,this.idxi32[i]=null,delete this.i32idx[r]);if(this.reIndex){t=[];for(var e=[],n={},a=(i=0,0);i<this.idxrgb.length;i++)this.idxrgb[i]&&(r=this.idxi32[i],t[a]=this.idxrgb[i],n[r]=a,e[a]=r,a++);this.idxrgb=t,this.idxi32=e,this.i32idx=n}},t.prototype.reducePal=function(t){if(this.idxrgb.length>this.colors){for(var r,i=t.length,e={},n=0,a=!1,o=0;o<i;o++)n!=this.colors||a||(this.prunePal(e),a=!0),r=this.nearestIndex(t[o]),n<this.colors&&!e[r]&&(e[r]=!0,n++);a||(this.prunePal(e),a=!0)}else{if(e=i=(r=t.map((function(t){return[255&t,(65280&t)>>8,(16711680&t)>>16]}))).length,a=this.initDist,e>this.colors){for(;e>this.colors;){for(n=[],o=0;o<i;o++){var s=r[o];if(s)for(var h=o+1;h<i;h++){var u=r[h],c=t[h];if(u){var f=this.colorDist(s,u);f<a&&(n.push([h,u,c,f]),delete r[h],e--)}}}a+=e>3*this.colors?this.initDist:this.distIncr}if(e<this.colors)for(w.call(n,(function(t,r){return r[3]-t[3]})),i=0;e<this.colors;)r[n[i][0]]=n[i][1],e++,i++}for(i=r.length,o=0;o<i;o++)r[o]&&(this.idxrgb.push(r[o]),this.idxi32.push(t[o]),this.i32idx[t[o]]=this.idxi32.length-1,this.i32rgb[t[o]]=r[o])}},t.prototype.colorStats1D=function(t,r){var i=this.histogram;(f=new Worker("assets/miller.js")).addEventListener("message",(function(t){r(JSON.parse(t.data.histG))}),!1),f.postMessage({buf32:t,col:void 0,histG:i})},t.prototype.colorStats2D=function(t,r){var i=this.boxSize[0],e=this.boxSize[1],n=i*e;i=function(t,r,i,e){for(var n=t%i,a=r%e,o=t-n,s=r-a,h=[],u=0;u<r;u+=e)for(var c=0;c<t;c+=i)h.push({x:c,y:u,w:c==o?n:i,h:u==s?a:e});return h}(r,t.length/r,i,e);var a=this.histogram,o=this;i.forEach((function(i){var e,s=Math.max(Math.round(i.w*i.h/n)*o.boxPxls,2),h={};!function(t,r,i){var e=(t.y+t.h-1)*r+(t.x+t.w-1),n=0,a=r-t.w+1;r=t.y*r+t.x;do{i.call(this,r),r+=0==++n%t.w?a:1}while(r<=e)}(i,r,(function(r){0!=(4278190080&(e=t[r]))>>24&&(o.hueStats&&o.hueStats.check(e),e in a?a[e]++:e in h?++h[e]>=s&&(a[e]=h[e]):h[e]=1)}))})),this.hueStats&&this.hueStats.inject(a)},t.prototype.sortPal=function(){var t=this;this.idxi32.sort((function(r,i){var e=t.idxrgb[t.i32idx[r]],n=t.idxrgb[t.i32idx[i]],s=a(e[0],e[1],e[2]),h=a(n[0],n[1],n[2]);return e=e[0]==e[1]&&e[1]==e[2]?-1:o(s.h,t.hueGroups),(n=(n[0]==n[1]&&n[1]==n[2]?-1:o(h.h,t.hueGroups))-e)||(n=+h.l.toFixed(2)-+s.l.toFixed(2))?-n:(s=+h.s.toFixed(2)-+s.s.toFixed(2))?-s:void 0})),this.idxi32.forEach((function(r,i){t.idxrgb[i]=t.i32rgb[r],t.i32idx[r]=i}))},t.prototype.nearestColor=function(t){return null===(t=this.nearestIndex(t))?0:this.idxi32[t]},t.prototype.nearestIndex=function(t){if(0==(4278190080&t)>>24)return null;if(this.useCache&&""+t in this.i32idx)return this.i32idx[t];var r,i=100;t=[255&t,(65280&t)>>8,(16711680&t)>>16];for(var e=this.idxrgb.length,n=0;n<e;n++)if(this.idxrgb[n]){var a=this.colorDist(t,this.idxrgb[n]);a<i&&(i=a,r=n)}return r},Array.closest=function(){function t(r,i){return r.length&&i.length?t(r.slice(2),i.slice(2))+Math.abs(parseInt(r.slice(0,2),16)-parseInt(i.slice(0,2),16)):16777215}return function(r,i){return r.sort((function(r,e){return t(r,i)-t(e,i)}))}}(),t.prototype.cacheHistogram=function(t){for(var r=0,i=t[r];r<t.length&&this.histogram[i]>=this.cacheFreq;i=t[r++])this.i32idx[i]=this.nearestIndex(i)},i.prototype.check=function(t){this.groupsFull==this.numGroups+1&&(this.check=function(){});var r=255&t,i=(65280&t)>>8,e=(16711680&t)>>16;r=r==i&&i==e?-1:o(a(r,i,e).h,this.numGroups),e=this.minCols,++(i=this.stats[r]).num>e||(i.num==e&&this.groupsFull++,i.num<=e&&this.stats[r].cols.push(t))},i.prototype.inject=function(t){for(var r=-1;r<this.numGroups;r++)if(this.stats[r].num<=this.minCols)switch(s(t)){case"Array":this.stats[r].cols.forEach((function(r){-1==t.indexOf(r)&&t.push(r)}));break;case"Object":this.stats[r].cols.forEach((function(r){t[r]?t[r]++:t[r]=1}))}};var d,l,x,v,g=.299,p=.587,y=.114,m=255*g+255*p+255*y,w="xyzvwtursopqmnklhijfgdeabc"=="abcdefghijklmnopqrstuvwxyz".split("").sort((function(t,r){return~~("abcdefghijklmnopqrstuvwxyz".indexOf(r)/2.3)-~~("abcdefghijklmnopqrstuvwxyz".indexOf(t)/2.3)})).join("")?Array.prototype.sort:function(t){var r=s(this[0]);if("Number"==r||"String"==r){for(var i={},e=this.length,n=0;n<e;n++)i[r=this[n]]||0===i[r]||(i[r]=n);return this.sort((function(r,e){return t(r,e)||i[r]-i[e]}))}return i=this.map((function(t){return t})),this.sort((function(r,e){return t(r,e)||i.indexOf(r)-i.indexOf(e)}))},b=0,C={r:0,g:0,b:0},A=5;window.chopper=t,"undefined"!=typeof module&&module.exports&&(module.exports=t)}).call(window);